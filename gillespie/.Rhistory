ls()
setwd('~/stochastic/gillespie')
source('~/stochastic/gillespie/parse_gillespie.R')
source('~/stochastic/gillespie/parse_gillespie.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
print tst
tst
bonus_concs.df = data.frame(concentrations.mat)
bonus_concs.df = data.frame(tst$concentrations.mat)
bonus_concs.df$YTotal = with(bonus_concs.df,Y + YP + M_Y + M_YP + 2*Y_Y)
conc.mlt = melt(bonus_concs.df,id.vars=c('times','trial'))
sub_cond = conc.mlt$variable %in% c('YTotal','P1','P2P','M','mR7','M_Y') & conc.mlt$trial %in% 1:10
g = ggplot(conc.mlt[sub_cond,],aes(times/3600,value,group=interaction(trial,variable),col=variable))
g = g + geom_line()
g
YT.df = bonus_concs.df[,c('times','YTotal')]
YT.summary = ddply(YT.df,c('times'),summarise,mean=mean(YTotal),sd=sd(YTotal),
cv=sd(YTotal)/mean(YTotal))
g = ggplot(YT.summary,aes(times,cv))
g = g + geom_line(aes(times/3600,cv))
# g = g + scale_y_continuous(limits=c(0,0.5))
g
